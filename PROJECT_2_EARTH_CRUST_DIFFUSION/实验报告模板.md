# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** [栗政澈]

**学号：** [20231050064]

**完成日期：** [6/13]


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律

---

## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

[在此描述你的数值方法实现，包括：]
空间和时间离散化：
深度域 $z \in [0, 20]$ 划分为 $M$ 个等距节点，空间步长 $h = \text{深度步长}$。
时间域划分为 $N$ 个时间步，时间步长 $\Delta t = \text{时间步长}$。
温度离散化为 $T_j^n \approx T(jh, n\Delta t)$

差分方程：
采用前向欧拉时间差分和中心空间差分格式：
T
j
n
+
1
=
T
j
n
+
r
(
T
j
+
1
n
−
2
T
j
n
+
T
j
−
1
n
)
T 
j
n+1
​
 =T 
j
n
​
 +r(T 
j+1
n
​
 −2T 
j
n
​
 +T 
j−1
n
​
 )
其中 $r = \frac{hD}{a^2}$，$a$ 是时间步长比例因子

边界条件处理：
地表边界：$T_0^n = A + B \sin(2\pi t_n / \tau)$
深层边界：$T_{M-1}^n = 11°\text{C}$（恒定）
初始条件：$T_j^0 = 10°\text{C}$（除边界点外）

稳定性条件：
稳定性要求：$r \leq \frac{1}{2}$
实验中取 $r = 0.1$ 确保数值稳定性
**稳定性分析：**
显式差分格式的稳定性由参数 $r = \frac{hD}{a^2}$ 决定。Von Neumann稳定性分析表明，当 $r \leq \frac{1}{2}$ 时格式稳定。实验中取 $h = 1.0$ m，$a = 1.0$，则 $r = \frac{1.0 \times 0.1}{1.0^2} = 0.1$，满足稳定性要求。


[讨论显式格式的稳定性特点，包括：]
- 稳定性参数 $r = \frac{hD}{a^2}$ 的值
- 时间步长选择的限制条件

---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数: $n_z$ =  [21]
- 时间步数: $n_t$ =  [366]
- 模拟总时间：[10] 年
- 稳定性参数: $r$ =  [0.1]

### 4.2 图表结果：季节性温度轮廓图

[在此粘贴季节性温度轮廓图图片]
![image](https://github.com/user-attachments/assets/44c3d0c6-c353-498b-bea9-da80869e35aa)

**图表分析：**
- 描述四个季节温度轮廓的差异
- 夏季（第180天）：地表温度最高（约22℃），温度随深度增加而下降

冬季（第0/365天）：地表温度最低（约-2℃），温度随深度增加而上升

春秋季（第90天和270天）：地表温度接近平均值10℃，温度梯度较小

振幅衰减规律：
地表温度振幅为12℃，随深度呈指数衰减：

z=5m处：振幅≈4.5℃

z=10m处：振幅≈1.5℃

z=15m处：振幅≈0.5℃
符合理论预测 $B(z) = B_0 e^{-z\sqrt{\pi/(D\tau)}}$
- 分析温度振幅随深度的衰减规律
- 讨论季节性影响的穿透深度
季节性影响的穿透深度约为15-18m，定义为振幅衰减到地表振幅5%的深度（≈0.6℃）。超过18m深度，温度几乎不随季节变化（<0.5℃波动）
---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

[分析模拟结果揭示的物理现象：]

热阻尼效应： 地壳的热惯性导致温度波动随深度衰减，深层温度变化滞后于地表

相位延迟： 温度波传播导致每米深度产生约30天的相位延迟

热扩散时间尺度： 热扰动穿透深度z所需时间 $t \sim z^2/D$，穿透20m深度约需4000天
### 5.4 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

   [你的回答]
深层温度季节性变化衰减源于热扩散方程的解具有指数衰减特性 $e^{-kz}$（$k=\sqrt{\omega/(2D)}$）。物理上，地壳的热容和热导率吸收了地表温度波动能量，且热扰动传播需要时间，导致深层温度变化幅度减小。

实际应用：

地热利用： 地下5-10m温度基本恒定（≈年平均气温），可作为地源热泵的稳定热源

古气候研究： 深层地温记录保存了历史气候信号

建筑节能： 地下室利用深层地温稳定性实现自然温度调节
3. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

   [你的回答]
显式格式优势：

实现简单： 只需当前时间步数据即可计算下一时间步

计算高效： 每个网格点计算量小（无矩阵求解）

内存需求低： 只需存储当前时间层数据

选择隐式格式的情况：

大扩散系数问题： 当 $D$ 较大时，显式格式要求 $\Delta t$ 过小

长期模拟： 隐式格式允许更大时间步长

高精度需求： 隐式格式通常具有更好的数值精度

多维问题： 显式格式稳定性条件在2D/3D问题中限制更严
---

## 6. 核心代码片段（可选）

```python
import numpy as np
import matplotlib.pyplot as plt

# 物理常数
D = 0.1  # 热扩散率 (m^2/day)
A = 10.0  # 年平均地表温度 (°C)
B = 12.0  # 地表温度振幅 (°C)
TAU = 365.0  # 年周期 (days)
T_BOTTOM = 11.0  # 20米深处温度 (°C)
T_INITIAL = 10.0  # 初始温度 (°C)
DEPTH_MAX = 20.0  # 最大深度 (m)


def solve_earth_crust_diffusion(h=1.0, a=1.0, M=21, N=366, years=10):
    """
    求解地壳热扩散方程 (显式差分格式)
    
    参数:
        h (float): 空间步长 (m)
        a (float): 时间步长比例因子
        M (int): 深度方向网格点数
        N (int): 时间步数
        years (int): 总模拟年数
    
    返回:
        tuple: (depth_array, temperature_matrix)
            - depth_array (ndarray): 深度数组 (m)
            - temperature_matrix (ndarray): 温度矩阵 [time, depth]
    """
    # 计算稳定性参数
    r = h * D / a**2
    print(f"稳定性参数 r = {r:.4f}")
    
    # 初始化温度矩阵
    T = np.zeros((M, N)) + T_INITIAL
    T[-1, :] = T_BOTTOM  # 底部边界条件
    
    # 时间步进循环
    for year in range(years):
        for j in range(1, N-1):
            # 地表边界条件
            T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)
            
            # 显式差分格式
            T[1:-1, j+1] = T[1:-1, j] + r * (T[2:, j] + T[:-2, j] - 2*T[1:-1, j])
    
    # 创建深度数组
    depth = np.arange(0, DEPTH_MAX + h, h)
    
    return depth, T


def plot_seasonal_profiles(depth, temperature, seasons=[90, 180, 270, 365]):
    """
    绘制季节性温度轮廓
    
    参数:
        depth (ndarray): 深度数组
        temperature (ndarray): 温度矩阵
        seasons (list): 季节时间点 (days)
    """
    plt.figure(figsize=(10, 8))
    
    # 绘制各季节的温度轮廓
    for i, day in enumerate(seasons):
        plt.plot(depth, temperature[:, day], 
                label=f'Day {day}', linewidth=2)
    plt.xlabel('Depth (m)')
    plt.ylabel('Temperature (°C)')
    plt.title('Seasonal Temperature Profiles')
    plt.grid(True)
    plt.legend()
    
    plt.show()


if __name__ == "__main__":
    # 运行模拟
    depth, T = solve_earth_crust_diffusion()
    
    # 绘制季节性温度轮廓
    plot_seasonal_profiles(depth, T)

```

